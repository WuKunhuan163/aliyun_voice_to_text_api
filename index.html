<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>阿里云语音识别API</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>💬</text></svg>">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="assets/stylesheets/main.css">
</head>
<body>
    <div class="container">
        <h1>阿里云语音识别API</h1>
        
        <!-- API配置区域 -->
        <div class="config-section">
                            <div class="form-group">
                <label>API地址:</label>
                <div class="input-with-copy">
                    <input type="text" id="apiUrlField" value="https://aliyun-voice-to-text-api.vercel.app/api/recognize" disabled readonly class="readonly-field">
                    <button type="button" class="copy-button" onclick="copyToClipboard('apiUrlField')" title="复制API地址">
                        <i class='bx bx-copy'></i>
                    </button>
                </div>
            </div>
            
            
            <div class="form-group">
                <label for="appKey">AppKey <span class="required">*</span></label>
                <input type="text" id="appKey" placeholder="从阿里云NLS控制台项目中获取">
            </div>
            <div class="form-group">
                <label for="accessKeyId">AccessKey ID <span class="required">*</span></label>
                <input type="text" id="accessKeyId" placeholder="从RAM用户管理页面获取">
            </div>
            <div class="form-group">
                <label for="accessKeySecret">AccessKey Secret <span class="required">*</span></label>
                <input type="password" id="accessKeySecret" placeholder="在RAM用户管理页面创建">
            </div>
            
            <div class="form-group">
                <label>Token:</label>
                <div class="input-with-copy">
                    <input type="text" id="tokenField" value="将在填写密钥后自动获取..." disabled readonly class="readonly-field">
                    <button type="button" class="copy-button" onclick="copyToClipboard('tokenField')" title="复制Token">
                        <i class='bx bx-copy'></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- 转录结果显示区域 - 模仿local_server设计 -->
        <div class="transcription-section">
            <div class="transcription-container">
                <!-- 细细的进度条在转录框内部顶端 -->
                <div class="progress-container-thin" id="transcriptionProgress">
                    <div class="progress-bar-thin" id="progressBarThin">
                        <div class="progress-fill-thin" id="progressFill"></div>
                    </div>
                </div>
                
                <!-- 音轨峰图 -->
                <div class="waveform-container" id="waveformContainer">
                    <svg class="waveform-svg" id="waveformSvg" width="100%" height="30" viewBox="0 0 1000 30" preserveAspectRatio="none">
                        <!-- 背景 -->
                        <rect class="waveform-background" x="0" y="0" width="1000" height="30" />
                        <!-- 峰值区域将动态生成 -->
                        <g id="waveformBars"></g>
                        <!-- 进度遮罩 -->
                        <rect class="waveform-progress-mask" id="waveformProgressMask" x="0" y="0" width="0" height="30" />
                    </svg>
                </div>
                
                <div id="transcriptionResult" class="transcription-result" 
                     data-placeholder="请先配置阿里云密钥信息...">
                    <!-- 初始为空，识别结果将显示在这里 -->
                </div>
            </div>
        </div>

        <!-- 录音测试区域 -->
        <div class="record-section">
            <button id="recordButton" class="record-button" disabled>开始录音测试</button>
            <button id="downloadButton" class="download-button" style="display: none;">下载录音</button>
        </div>
    </div>

    <script src="assets/scripts/main.js"></script>
    <script>
        // 复制到剪贴板功能
        function copyToClipboard(fieldId) {
            const field = document.getElementById(fieldId);
            const text = field.value;
            
            if (!text || text === '将在填写密钥后自动获取...' || text === '获取失败，请检查密钥信息') {
                alert('没有可复制的内容');
                return;
            }
            
            // 使用现代的Clipboard API
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('复制成功！');
                }).catch(() => {
                    // 如果Clipboard API失败，使用传统方法
                    fallbackCopy(field);
                });
            } else {
                // 使用传统的复制方法
                fallbackCopy(field);
            }
        }
        
        function fallbackCopy(field) {
            try {
                field.select();
                field.setSelectionRange(0, 99999); // 对移动设备
                document.execCommand('copy');
                alert('复制成功！');
            } catch (err) {
                alert('复制失败，请手动复制');
                console.error('复制失败:', err);
            }
        }
    </script>
</body>
</html>
